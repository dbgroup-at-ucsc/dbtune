
SELECT COUNT(*)
  FROM tpcds.store_sales,
       tpcds.household_demographics,
       tpcds.time_dim,
       tpcds.store
 WHERE ss_sold_time_sk = t_time_sk
       AND ss_hdemo_sk = hd_demo_sk
       AND ss_store_sk = s_store_sk
       AND t_hour = 8
       AND t_minute >= 30
       AND hd_dep_count = 2
       AND s_store_name = 'ese'
 ORDER BY COUNT(*);

# DBTune

workload name	 query number	 candidate subsets for query	 candidate set size	 INUM prepare time	 INUM cost	 optimizer cost	 cost ratio (optimizer cost / INUM cost)	 optimizer cost / (optimizer cost / STDEV(cost ratio))	 INUM explain time	 optimizer explain time	 explain time ratio (optimizer explain time/ INUM explain time)	optimizer explain time / AVG INUM per-whatif explain time	indexes used by INUM	 indexes used by optimizer	 difference in index usage	 optimizer using index intersection or union	 optimizer using NLJ	 INUM using NLJ
resources/test-workloads/db2//tpcds-inum	1	1	4	1690463596	91155.54474925995	18458.826171875	=G1/F1	=G1/G2	514801302	159141468	=K1/J1	=K1/L2	3	4	1	N	Y	N

# JDBC

     [java] inum prepare: 632770815
     [java] inum: 406583560
     [java] optimizer: 125357960

# db2 command line

inum prepare 1434598091 
inum explain 943284389 
opt explain 307953438 


stmts

db2 connect to test
before=$(($(date +%s%N)))
db2 "DELETE FROM SYSTOOLS.ADVISE_INDEX"
db2 "DELETE FROM SYSTOOLS.EXPLAIN_INSTANCE"
db2 "SET CURRENT EXPLAIN MODE = EVALUATE INDEXES"
db2 "SELECT COUNT(*) FROM tpcds.store_sales, tpcds.household_demographics, tpcds.time_dim, tpcds.store WHERE ss_sold_time_sk = t_time_sk AND ss_hdemo_sk = hd_demo_sk AND ss_store_sk = s_store_sk AND t_hour = 8 AND t_minute >= 30 AND hd_dep_count = 2 AND s_store_name = 'ese' ORDER BY COUNT(*)"
db2 "SET CURRENT EXPLAIN MODE = NO"
db2 "SELECT      o.operator_id    AS node_id,      s2.target_id     AS parent_id,      o.operator_type  AS operator_name,      s1.object_schema AS object_schema,      s1.object_name   AS object_name,     s1.stream_count  AS cardinality,      o.total_cost     AS cost,      cast(cast(s1.column_names AS CLOB(2097152)) AS VARCHAR(2048))                       AS column_names   FROM      systools.explain_operator o         LEFT OUTER JOIN      systools.explain_stream s2 ON               o.operator_id = s2.source_id            AND (                  s2.target_id >= 0                OR s2.target_id IS NULL                )        LEFT OUTER JOIN      systools.explain_stream s1 ON               o.operator_id = s1.target_id           AND o.explain_time = s1.explain_time           AND s1.object_name IS NOT NULL   ORDER BY      o.operator_id ASC"
db2 " SELECT    o.operator_id   AS node_id,    CAST(CAST(p.predicate_text AS CLOB(2097152)) AS VARCHAR(2048))                    AS predicate_text  FROM    systools.explain_operator o       LEFT OUTER JOIN        systools.explain_predicate p          ON o.operator_id = p.operator_id  ORDER BY           o.operator_id ASC "
db2 "SET CURRENT OPTIMIZATION PROFILE = ''"
db2 "FLUSH OPTIMIZATION PROFILE CACHE"
db2 "DELETE FROM SYSTOOLS.ADVISE_INDEX"
db2 "DELETE FROM SYSTOOLS.EXPLAIN_INSTANCE"
db2 "SET CURRENT EXPLAIN MODE = EVALUATE INDEXES"
db2 "SELECT COUNT(*) FROM tpcds.store_sales, tpcds.household_demographics, tpcds.time_dim, tpcds.store WHERE ss_sold_time_sk = t_time_sk AND ss_hdemo_sk = hd_demo_sk AND ss_store_sk = s_store_sk AND t_hour = 8 AND t_minute >= 30 AND hd_dep_count = 2 AND s_store_name = 'ese' ORDER BY COUNT(*)"
db2 "SET CURRENT EXPLAIN MODE = NO"
db2 "SELECT      o.operator_id    AS node_id,      s2.target_id     AS parent_id,      o.operator_type  AS operator_name,      s1.object_schema AS object_schema,      s1.object_name   AS object_name,     s1.stream_count  AS cardinality,      o.total_cost     AS cost,      cast(cast(s1.column_names AS CLOB(2097152)) AS VARCHAR(2048))                       AS column_names   FROM      systools.explain_operator o         LEFT OUTER JOIN      systools.explain_stream s2 ON               o.operator_id = s2.source_id            AND (                  s2.target_id >= 0                OR s2.target_id IS NULL                )        LEFT OUTER JOIN      systools.explain_stream s1 ON               o.operator_id = s1.target_id           AND o.explain_time = s1.explain_time           AND s1.object_name IS NOT NULL   ORDER BY      o.operator_id ASC"
db2 " SELECT    o.operator_id   AS node_id,    CAST(CAST(p.predicate_text AS CLOB(2097152)) AS VARCHAR(2048))                    AS predicate_text  FROM    systools.explain_operator o       LEFT OUTER JOIN        systools.explain_predicate p          ON o.operator_id = p.operator_id  ORDER BY           o.operator_id ASC "
db2 "SET CURRENT OPTIMIZATION PROFILE = ''"
db2 "FLUSH OPTIMIZATION PROFILE CACHE"
db2 "DELETE FROM SYSTOOLS.ADVISE_INDEX"
db2 "DELETE FROM SYSTOOLS.EXPLAIN_INSTANCE"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'TIME_DIM',  '+T_TIME_SK',  1, 'D', -1, 'N', 'REG',  'TPCDS.dbtune_11_index', 'D', 'N', '0',  11,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'STORE_SALES',  '+SS_SOLD_TIME_SK',  1, 'D', -1, 'N', 'REG',  'TPCDS.dbtune_9_index', 'D', 'N', '0',  9,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'STORE',  '+S_STORE_SK',  1, 'D', -1, 'N', 'REG',  'TPCDS.dbtune_12_index', 'D', 'N', '0',  12,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'STORE_SALES',  '+SS_STORE_SK',  1, 'D', -1, 'N', 'REG',  'TPCDS.dbtune_13_index', 'D', 'N', '0',  13,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'STORE_SALES',  '+SS_HDEMO_SK',  1, 'D', -1, 'N', 'REG',  'TPCDS.dbtune_8_index', 'D', 'N', '0',  8,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'HOUSEHOLD_DEMOGRAPHICS',  '+HD_DEMO_SK',  1, 'D', -1, 'N', 'REG',  'TPCDS.dbtune_10_index', 'D', 'N', '0',  10,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "SET CURRENT EXPLAIN MODE = EVALUATE INDEXES"
db2 "SELECT COUNT(*) FROM tpcds.store_sales, tpcds.household_demographics, tpcds.time_dim, tpcds.store WHERE ss_sold_time_sk = t_time_sk AND ss_hdemo_sk = hd_demo_sk AND ss_store_sk = s_store_sk AND t_hour = 8 AND t_minute >= 30 AND hd_dep_count = 2 AND s_store_name = 'ese' ORDER BY COUNT(*)"
db2 "SET CURRENT EXPLAIN MODE = NO"
db2 "SELECT      o.operator_id    AS node_id,      s2.target_id     AS parent_id,      o.operator_type  AS operator_name,      s1.object_schema AS object_schema,      s1.object_name   AS object_name,     s1.stream_count  AS cardinality,      o.total_cost     AS cost,      cast(cast(s1.column_names AS CLOB(2097152)) AS VARCHAR(2048))                       AS column_names   FROM      systools.explain_operator o         LEFT OUTER JOIN      systools.explain_stream s2 ON               o.operator_id = s2.source_id            AND (                  s2.target_id >= 0                OR s2.target_id IS NULL                )        LEFT OUTER JOIN      systools.explain_stream s1 ON               o.operator_id = s1.target_id           AND o.explain_time = s1.explain_time           AND s1.object_name IS NOT NULL   ORDER BY      o.operator_id ASC"
db2 " SELECT    o.operator_id   AS node_id,    CAST(CAST(p.predicate_text AS CLOB(2097152)) AS VARCHAR(2048))                    AS predicate_text  FROM    systools.explain_operator o       LEFT OUTER JOIN        systools.explain_predicate p          ON o.operator_id = p.operator_id  ORDER BY           o.operator_id ASC "
db2 "SET CURRENT OPTIMIZATION PROFILE = ''"
db2 "FLUSH OPTIMIZATION PROFILE CACHE"
db2 "DELETE FROM SYSTOOLS.ADVISE_INDEX"
db2 "DELETE FROM SYSTOOLS.EXPLAIN_INSTANCE"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'TIME_DIM',  '+T_TIME_SK',  1, 'D', -1, 'N', 'REG',  'TPCDS.dbtune_11_index', 'D', 'N', '0',  11,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'STORE_SALES',  '+SS_SOLD_TIME_SK',  1, 'D', -1, 'N', 'REG',  'TPCDS.dbtune_9_index', 'D', 'N', '0',  9,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'STORE',  '+S_STORE_SK',  1, 'D', -1, 'N', 'REG',  'TPCDS.dbtune_12_index', 'D', 'N', '0',  12,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'HOUSEHOLD_DEMOGRAPHICS',  '+HD_DEMO_SK',  1, 'D', -1, 'N', 'REG',  'TPCDS.dbtune_10_index', 'D', 'N', '0',  10,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'STORE_SALES',  '+SS_HDEMO_SK',  1, 'D', -1, 'N', 'REG',  'TPCDS.dbtune_8_index', 'D', 'N', '0',  8,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "SET CURRENT EXPLAIN MODE = EVALUATE INDEXES"
db2 "SELECT COUNT(*) FROM tpcds.store_sales, tpcds.household_demographics, tpcds.time_dim, tpcds.store WHERE ss_sold_time_sk = t_time_sk AND ss_hdemo_sk = hd_demo_sk AND ss_store_sk = s_store_sk AND t_hour = 8 AND t_minute >= 30 AND hd_dep_count = 2 AND s_store_name = 'ese' ORDER BY COUNT(*)"
db2 "SET CURRENT EXPLAIN MODE = NO"
db2 "SELECT      o.operator_id    AS node_id,      s2.target_id     AS parent_id,      o.operator_type  AS operator_name,      s1.object_schema AS object_schema,      s1.object_name   AS object_name,     s1.stream_count  AS cardinality,      o.total_cost     AS cost,      cast(cast(s1.column_names AS CLOB(2097152)) AS VARCHAR(2048))                       AS column_names   FROM      systools.explain_operator o         LEFT OUTER JOIN      systools.explain_stream s2 ON               o.operator_id = s2.source_id            AND (                  s2.target_id >= 0                OR s2.target_id IS NULL                )        LEFT OUTER JOIN      systools.explain_stream s1 ON               o.operator_id = s1.target_id           AND o.explain_time = s1.explain_time           AND s1.object_name IS NOT NULL   ORDER BY      o.operator_id ASC"
db2 " SELECT    o.operator_id   AS node_id,    CAST(CAST(p.predicate_text AS CLOB(2097152)) AS VARCHAR(2048))                    AS predicate_text  FROM    systools.explain_operator o       LEFT OUTER JOIN        systools.explain_predicate p          ON o.operator_id = p.operator_id  ORDER BY           o.operator_id ASC "
db2 "SET CURRENT OPTIMIZATION PROFILE = ''"
db2 "FLUSH OPTIMIZATION PROFILE CACHE"
db2 "DELETE FROM SYSTOOLS.ADVISE_INDEX"
db2 "DELETE FROM SYSTOOLS.EXPLAIN_INSTANCE"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'HOUSEHOLD_DEMOGRAPHICS',  '+HD_DEP_COUNT+HD_DEMO_SK',  2, 'D', -1, 'Y', 'REG',  'TPCDS.dbtune_3_index', 'D', 'N', '0',  3,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'STORE_SALES',  '+SS_STORE_SK+SS_HDEMO_SK+SS_SOLD_TIME_SK',  3, 'D', -1, 'Y', 'REG',  'TPCDS.dbtune_1_index', 'D', 'N', '0',  1,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'STORE',  '+S_STORE_NAME+S_STORE_SK',  2, 'D', -1, 'Y', 'REG',  'TPCDS.dbtune_0_index', 'D', 'N', '0',  0,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'TIME_DIM',  '+T_MINUTE+T_HOUR+T_TIME_SK',  3, 'D', -1, 'N', 'REG',  'TPCDS.dbtune_14_index', 'D', 'N', '0',  14,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "SET CURRENT EXPLAIN MODE = EVALUATE INDEXES"
db2 "SELECT COUNT(*) FROM tpcds.store_sales, tpcds.household_demographics, tpcds.time_dim, tpcds.store WHERE ss_sold_time_sk = t_time_sk AND ss_hdemo_sk = hd_demo_sk AND ss_store_sk = s_store_sk AND t_hour = 8 AND t_minute >= 30 AND hd_dep_count = 2 AND s_store_name = 'ese' ORDER BY COUNT(*)"
db2 "SET CURRENT EXPLAIN MODE = NO"
db2 "SELECT      o.operator_id    AS node_id,      s2.target_id     AS parent_id,      o.operator_type  AS operator_name,      s1.object_schema AS object_schema,      s1.object_name   AS object_name,     s1.stream_count  AS cardinality,      o.total_cost     AS cost,      cast(cast(s1.column_names AS CLOB(2097152)) AS VARCHAR(2048))                       AS column_names   FROM      systools.explain_operator o         LEFT OUTER JOIN      systools.explain_stream s2 ON               o.operator_id = s2.source_id            AND (                  s2.target_id >= 0                OR s2.target_id IS NULL                )        LEFT OUTER JOIN      systools.explain_stream s1 ON               o.operator_id = s1.target_id           AND o.explain_time = s1.explain_time           AND s1.object_name IS NOT NULL   ORDER BY      o.operator_id ASC"
db2 " SELECT    o.operator_id   AS node_id,    CAST(CAST(p.predicate_text AS CLOB(2097152)) AS VARCHAR(2048))                    AS predicate_text  FROM    systools.explain_operator o       LEFT OUTER JOIN        systools.explain_predicate p          ON o.operator_id = p.operator_id  ORDER BY           o.operator_id ASC "
db2 "SET CURRENT OPTIMIZATION PROFILE = ''"
db2 "FLUSH OPTIMIZATION PROFILE CACHE"
after=$(($(date +%s%N)))
echo inum prepare time `expr $after - $before`
####################
before=$(($(date +%s%N)))
db2 "DELETE FROM SYSTOOLS.ADVISE_INDEX"
db2 "DELETE FROM SYSTOOLS.EXPLAIN_INSTANCE"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'STORE_SALES',  '+SS_STORE_SK+SS_HDEMO_SK+SS_SOLD_TIME_SK',  3, 'D', -1, 'Y', 'REG',  'TPCDS.dbtune_1_index', 'D', 'N', '0',  1,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "SET CURRENT EXPLAIN MODE = EVALUATE INDEXES"
db2 "SELECT SS_STORE_SK, SS_HDEMO_SK, SS_SOLD_TIME_SK  FROM TPCDS.STORE_SALES"
db2 "SET CURRENT EXPLAIN MODE = NO"
db2 "SELECT      o.operator_id    AS node_id,      s2.target_id     AS parent_id,      o.operator_type  AS operator_name,      s1.object_schema AS object_schema,      s1.object_name   AS object_name,     s1.stream_count  AS cardinality,      o.total_cost     AS cost,      cast(cast(s1.column_names AS CLOB(2097152)) AS VARCHAR(2048))                       AS column_names   FROM      systools.explain_operator o         LEFT OUTER JOIN      systools.explain_stream s2 ON               o.operator_id = s2.source_id            AND (                  s2.target_id >= 0                OR s2.target_id IS NULL                )        LEFT OUTER JOIN      systools.explain_stream s1 ON               o.operator_id = s1.target_id           AND o.explain_time = s1.explain_time           AND s1.object_name IS NOT NULL   ORDER BY      o.operator_id ASC"
db2 " SELECT    o.operator_id   AS node_id,    CAST(CAST(p.predicate_text AS CLOB(2097152)) AS VARCHAR(2048))                    AS predicate_text  FROM    systools.explain_operator o       LEFT OUTER JOIN        systools.explain_predicate p          ON o.operator_id = p.operator_id  ORDER BY           o.operator_id ASC "
db2 "SET CURRENT OPTIMIZATION PROFILE = ''"
db2 "FLUSH OPTIMIZATION PROFILE CACHE"
db2 "DELETE FROM SYSTOOLS.ADVISE_INDEX"
db2 "DELETE FROM SYSTOOLS.EXPLAIN_INSTANCE"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'TIME_DIM',  '+T_HOUR+T_MINUTE+T_TIME_SK',  3, 'D', -1, 'Y', 'REG',  'TPCDS.dbtune_2_index', 'D', 'N', '0',  2,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "SET CURRENT EXPLAIN MODE = EVALUATE INDEXES"
db2 "SELECT T_MINUTE, T_HOUR, T_TIME_SK  FROM TPCDS.TIME_DIM WHERE (30 <= T_MINUTE) AND (T_HOUR = 8) "
db2 "SET CURRENT EXPLAIN MODE = NO"
db2 "SELECT      o.operator_id    AS node_id,      s2.target_id     AS parent_id,      o.operator_type  AS operator_name,      s1.object_schema AS object_schema,      s1.object_name   AS object_name,     s1.stream_count  AS cardinality,      o.total_cost     AS cost,      cast(cast(s1.column_names AS CLOB(2097152)) AS VARCHAR(2048))                       AS column_names   FROM      systools.explain_operator o         LEFT OUTER JOIN      systools.explain_stream s2 ON               o.operator_id = s2.source_id            AND (                  s2.target_id >= 0                OR s2.target_id IS NULL                )        LEFT OUTER JOIN      systools.explain_stream s1 ON               o.operator_id = s1.target_id           AND o.explain_time = s1.explain_time           AND s1.object_name IS NOT NULL   ORDER BY      o.operator_id ASC"
db2 " SELECT    o.operator_id   AS node_id,    CAST(CAST(p.predicate_text AS CLOB(2097152)) AS VARCHAR(2048))                    AS predicate_text  FROM    systools.explain_operator o       LEFT OUTER JOIN        systools.explain_predicate p          ON o.operator_id = p.operator_id  ORDER BY           o.operator_id ASC "
db2 "SET CURRENT OPTIMIZATION PROFILE = ''"
db2 "FLUSH OPTIMIZATION PROFILE CACHE"
db2 "DELETE FROM SYSTOOLS.ADVISE_INDEX"
db2 "DELETE FROM SYSTOOLS.EXPLAIN_INSTANCE"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'HOUSEHOLD_DEMOGRAPHICS',  '+HD_DEP_COUNT+HD_DEMO_SK',  2, 'D', -1, 'Y', 'REG',  'TPCDS.dbtune_3_index', 'D', 'N', '0',  3,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "SET CURRENT EXPLAIN MODE = EVALUATE INDEXES"
db2 "SELECT HD_DEP_COUNT, HD_DEMO_SK  FROM TPCDS.HOUSEHOLD_DEMOGRAPHICS WHERE (HD_DEP_COUNT = 2) "
db2 "SET CURRENT EXPLAIN MODE = NO"
db2 "SELECT      o.operator_id    AS node_id,      s2.target_id     AS parent_id,      o.operator_type  AS operator_name,      s1.object_schema AS object_schema,      s1.object_name   AS object_name,     s1.stream_count  AS cardinality,      o.total_cost     AS cost,      cast(cast(s1.column_names AS CLOB(2097152)) AS VARCHAR(2048))                       AS column_names   FROM      systools.explain_operator o         LEFT OUTER JOIN      systools.explain_stream s2 ON               o.operator_id = s2.source_id            AND (                  s2.target_id >= 0                OR s2.target_id IS NULL                )        LEFT OUTER JOIN      systools.explain_stream s1 ON               o.operator_id = s1.target_id           AND o.explain_time = s1.explain_time           AND s1.object_name IS NOT NULL   ORDER BY      o.operator_id ASC"
db2 " SELECT    o.operator_id   AS node_id,    CAST(CAST(p.predicate_text AS CLOB(2097152)) AS VARCHAR(2048))                    AS predicate_text  FROM    systools.explain_operator o       LEFT OUTER JOIN        systools.explain_predicate p          ON o.operator_id = p.operator_id  ORDER BY           o.operator_id ASC "
db2 "SET CURRENT OPTIMIZATION PROFILE = ''"
db2 "FLUSH OPTIMIZATION PROFILE CACHE"
db2 "DELETE FROM SYSTOOLS.ADVISE_INDEX"
db2 "DELETE FROM SYSTOOLS.EXPLAIN_INSTANCE"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'STORE',  '+S_STORE_NAME+S_STORE_SK',  2, 'D', -1, 'Y', 'REG',  'TPCDS.dbtune_0_index', 'D', 'N', '0',  0,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "SET CURRENT EXPLAIN MODE = EVALUATE INDEXES"
db2 "SELECT S_STORE_NAME, S_STORE_SK  FROM TPCDS.STORE WHERE (S_STORE_NAME = 'ese') "
db2 "SET CURRENT EXPLAIN MODE = NO"
db2 "SELECT      o.operator_id    AS node_id,      s2.target_id     AS parent_id,      o.operator_type  AS operator_name,      s1.object_schema AS object_schema,      s1.object_name   AS object_name,     s1.stream_count  AS cardinality,      o.total_cost     AS cost,      cast(cast(s1.column_names AS CLOB(2097152)) AS VARCHAR(2048))                       AS column_names   FROM      systools.explain_operator o         LEFT OUTER JOIN      systools.explain_stream s2 ON               o.operator_id = s2.source_id            AND (                  s2.target_id >= 0                OR s2.target_id IS NULL                )        LEFT OUTER JOIN      systools.explain_stream s1 ON               o.operator_id = s1.target_id           AND o.explain_time = s1.explain_time           AND s1.object_name IS NOT NULL   ORDER BY      o.operator_id ASC"
db2 " SELECT    o.operator_id   AS node_id,    CAST(CAST(p.predicate_text AS CLOB(2097152)) AS VARCHAR(2048))                    AS predicate_text  FROM    systools.explain_operator o       LEFT OUTER JOIN        systools.explain_predicate p          ON o.operator_id = p.operator_id  ORDER BY           o.operator_id ASC "
db2 "SET CURRENT OPTIMIZATION PROFILE = ''"
db2 "FLUSH OPTIMIZATION PROFILE CACHE"
after=$(($(date +%s%N)))
echo inum explain time `expr $after - $before`
before=$(($(date +%s%N)))
db2 "DELETE FROM SYSTOOLS.ADVISE_INDEX"
db2 "DELETE FROM SYSTOOLS.EXPLAIN_INSTANCE"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'HOUSEHOLD_DEMOGRAPHICS',  '+HD_DEP_COUNT+HD_DEMO_SK',  2, 'D', -1, 'Y', 'REG',  'TPCDS.dbtune_3_index', 'D', 'N', '0',  3,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'STORE_SALES',  '+SS_STORE_SK+SS_HDEMO_SK+SS_SOLD_TIME_SK',  3, 'D', -1, 'Y', 'REG',  'TPCDS.dbtune_1_index', 'D', 'N', '0',  1,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'STORE',  '+S_STORE_NAME+S_STORE_SK',  2, 'D', -1, 'Y', 'REG',  'TPCDS.dbtune_0_index', 'D', 'N', '0',  0,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "INSERT INTO systools.advise_index (   EXPLAIN_REQUESTER,    TBCREATOR,    TBNAME,    COLNAMES,    COLCOUNT,    UNIQUERULE,    UNIQUE_COLCOUNT,    REVERSE_SCANS,    INDEXTYPE,    NAME,    CREATION_TEXT,    EXISTS,    SYSTEM_REQUIRED,    iid,    USE_INDEX,    NLEAF,    NLEVELS,    FIRSTKEYCARD,    FULLKEYCARD,    CLUSTERRATIO,    AVGPARTITION_CLUSTERRATIO,    AVGPARTITION_CLUSTERFACTOR,    AVGPARTITION_PAGE_FETCH_PAIRS,    DATAPARTITION_CLUSTERFACTOR,    CLUSTERFACTOR,    SEQUENTIAL_PAGES,    DENSITY,    FIRST2KEYCARD,    FIRST3KEYCARD,    FIRST4KEYCARD,    PCTFREE,    PAGE_FETCH_PAIRS,    MINPCTUSED,    EXPLAIN_TIME,    CREATE_TIME,    STATS_TIME,    SOURCE_NAME,    REMARKS,    CREATOR,    DEFINER,    SOURCE_SCHEMA,    SOURCE_VERSION,    EXPLAIN_LEVEL,    USERDEFINED,    STMTNO,    SECTNO,    QUERYNO,    QUERYTAG,    PACKED_DESC,    RUN_ID,    RIDTOBLOCK,    CONVERTED)  VALUES (   'DBTune', 'TPCDS',  'TIME_DIM',  '+T_HOUR+T_MINUTE+T_TIME_SK',  3, 'D', -1, 'Y', 'REG',  'TPCDS.dbtune_2_index', 'D', 'N', '0',  2,    'Y',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    -1,    -1,    -1,    -1,    -1,    -1,    -1,    -1,    '',    0 ,    CURRENT TIMESTAMP,    CURRENT TIMESTAMP,    NULL,    'DBTune',    'Created by DBTune',    'SYSTEM',    'SYSTEM',    'NULLID',    '',    'P',    1,    1,    1,    1,    '',    NULL,    NULL,    'N',    'Z')"
db2 "SET CURRENT EXPLAIN MODE = EVALUATE INDEXES"
db2 "SELECT COUNT(*) FROM tpcds.store_sales, tpcds.household_demographics, tpcds.time_dim, tpcds.store WHERE ss_sold_time_sk = t_time_sk AND ss_hdemo_sk = hd_demo_sk AND ss_store_sk = s_store_sk AND t_hour = 8 AND t_minute >= 30 AND hd_dep_count = 2 AND s_store_name = 'ese' ORDER BY COUNT(*)"
db2 "SET CURRENT EXPLAIN MODE = NO"
db2 "SELECT      o.operator_id    AS node_id,      s2.target_id     AS parent_id,      o.operator_type  AS operator_name,      s1.object_schema AS object_schema,      s1.object_name   AS object_name,     s1.stream_count  AS cardinality,      o.total_cost     AS cost,      cast(cast(s1.column_names AS CLOB(2097152)) AS VARCHAR(2048))                       AS column_names   FROM      systools.explain_operator o         LEFT OUTER JOIN      systools.explain_stream s2 ON               o.operator_id = s2.source_id            AND (                  s2.target_id >= 0                OR s2.target_id IS NULL                )        LEFT OUTER JOIN      systools.explain_stream s1 ON               o.operator_id = s1.target_id           AND o.explain_time = s1.explain_time           AND s1.object_name IS NOT NULL   ORDER BY      o.operator_id ASC"
db2 " SELECT    o.operator_id   AS node_id,    CAST(CAST(p.predicate_text AS CLOB(2097152)) AS VARCHAR(2048))                    AS predicate_text  FROM    systools.explain_operator o       LEFT OUTER JOIN        systools.explain_predicate p          ON o.operator_id = p.operator_id  ORDER BY           o.operator_id ASC "
db2 "SET CURRENT OPTIMIZATION PROFILE = ''"
db2 "FLUSH OPTIMIZATION PROFILE CACHE"
after=$(($(date +%s%N)))
echo optimizer time `expr $after - $before`
